(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1069],{24654:function(){},80176:function(e,n,t){Promise.resolve().then(t.bind(t,40919))},10980:function(e,n,t){"use strict";t.d(n,{g:function(){return s}});var r=t(49135);async function s(e){return r.Z.post("/api/upload",e)}},61250:function(e,n,t){"use strict";t.d(n,{DZ:function(){return o},M_:function(){return i},RF:function(){return u},lE:function(){return a},pf:function(){return c},x4:function(){return d}});var r=t(49135),s=t(13374),l=t.n(s);async function a(e){return r.Z.get("/api/users?".concat(l().stringify(e)))}async function u(e){return r.Z.post("/api/users",e)}async function i(e){return r.Z.get("/api/users/".concat(e))}async function o(e){return r.Z.delete("/api/users/".concat(e))}async function c(e,n){return r.Z.put("/api/users/".concat(e),n)}async function d(e){return r.Z.post("/api/users/login",e)}},40919:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return i}});var r=t(3827),s=t(61250),l=t(38797),a=t(47907),u=t(64090);function i(){let e=(0,a.useParams)().id,[n,t]=(0,u.useState)();async function i(){let{data:n}=await (0,s.M_)(e);t(n)}return(0,u.useEffect)(()=>{e&&i()},[e]),(0,r.jsx)(l.default,{title:"用户编辑",editData:n})}},20629:function(e,n,t){"use strict";t.d(n,{Z:function(){return a}});var r=t(3827);t(64090);var s=t(71583),l=t.n(s);function a(e){let{children:n,title:t,operation:s}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:l().title,children:[t,(0,r.jsx)("span",{className:l().btn,children:s})]}),(0,r.jsx)("div",{className:l().content,children:n})]})}},38797:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return g}});var r=t(3827),s=t(64090),l=t(81583),a=t(80588),u=t(44839),i=t(61773),o=t(66577),c=t(13565),d=t(47907),f=t(17570),p=t.n(f),m=t(20629),h=t(61250),x=t(93812),Z=t(66155),v=t(74325),j=t(10980);function g(e){let{title:n,editData:t={sex:x.Om.MALE,status:x.iy.ON,role:x.N1.BUYER,_id:""}}=e,f=(0,d.useRouter)(),[g]=l.Z.useForm(),[b,y]=(0,s.useState)(!1),[_,P]=(0,s.useState)(),[N,E]=(0,s.useState)(!1),[w,F]=(0,s.useState)(""),[I,S]=(0,s.useState)(""),[k,O]=(0,s.useState)([]);(0,s.useEffect)(()=>{console.log(t),t._id&&g.setFieldsValue(t)},[t,g]);let q=async e=>{console.log(e),t._id?(e.avatar=_||"",await (0,h.pf)(t._id,e),a.ZP.success("更新成功")):(e.avatar=_||"",await (0,h.RF)(e),a.ZP.success("创建成功")),f.push("/user")};(0,s.useEffect)(()=>{(async()=>{await (0,j.g)().then(e=>{console.log("token",e.data.token),S(e.data.token)})})()},[]);let L=(0,r.jsxs)("button",{style:{border:0,background:"none"},type:"button",children:[b?(0,r.jsx)(Z.Z,{}):(0,r.jsx)(v.Z,{}),(0,r.jsx)("div",{style:{marginTop:8},children:"上传"})]});return(0,r.jsx)(m.Z,{title:n,children:(0,r.jsxs)(l.Z,{labelCol:{span:4},wrapperCol:{span:16},layout:"horizontal",onFinish:q,initialValues:t,form:g,children:[(0,r.jsx)(l.Z.Item,{label:"账号",name:"name",rules:[{required:!0,message:"请输入账号"}],children:(0,r.jsx)(u.default,{placeholder:"请输入"})}),(0,r.jsx)(l.Z.Item,{label:"名称",name:"nickName",rules:[{required:!0,message:"请输入名称"}],children:(0,r.jsx)(u.default,{placeholder:"请输入"})}),(0,r.jsx)(l.Z.Item,{label:"性别",name:"sex",rules:[{required:!0,message:"请选择性别"}],children:(0,r.jsxs)(i.ZP.Group,{children:[(0,r.jsx)(i.ZP,{value:"male",children:"男"}),(0,r.jsx)(i.ZP,{value:"female",children:"女"})]})}),(0,r.jsx)(l.Z.Item,{label:"密码",name:"password",rules:[{required:!0,message:"请输入密码"}],children:(0,r.jsx)(u.default.Password,{placeholder:"请输入"})}),(0,r.jsx)(l.Z.Item,{label:"状态",name:"status",rules:[{required:!0,message:"请选择状态"}],children:(0,r.jsxs)(i.ZP.Group,{children:[(0,r.jsx)(i.ZP,{value:"on",children:"正常"}),(0,r.jsx)(i.ZP,{value:"off",children:"禁用"})]})}),(0,r.jsx)(l.Z.Item,{label:"角色",name:"role",rules:[{required:!0,message:"请选择角色"}],children:(0,r.jsxs)(i.ZP.Group,{children:[(0,r.jsx)(i.ZP,{value:"buyer",children:"买家"}),(0,r.jsx)(i.ZP,{value:"seller",children:"商家"}),(0,r.jsx)(i.ZP,{value:"admin",children:"管理员"})]})}),(0,r.jsx)(l.Z.Item,{label:"手机号",name:"phone",rules:[{required:!0,message:"请输入手机号"}],children:(0,r.jsx)(u.default,{placeholder:"请输入手机号"})}),(0,r.jsx)(l.Z.Item,{label:"头像",name:"avatar",children:(0,r.jsx)(o.Z,{name:"file",listType:"picture-card",className:"avatar-uploader",action:"http://upload-z2.qiniup.com",data:{token:I},beforeUpload:e=>{let n="image/jpeg"===e.type||"image/png"===e.type;return n||a.ZP.error("You can only upload JPG/PNG file!"),n},fileList:k,onPreview:e=>{console.log(e),F(e.url||e.thumbUrl),E(!0)},onChange:e=>{let n=e.file,t=e.fileList;console.log("fileList",e.fileList);let{uid:r,name:s,type:l,thumbUrl:a,status:u,response:i={}}=n,o={uid:r,name:s,type:l,thumbUrl:a,status:u,url:"http://sbwwsba9t.hn-bkt.clouddn.com/"+(i.hash||"")};t.pop(),t.push(o),P(o.url),console.log(t),O([...t])},onRemove:e=>{console.log(e);let n=k.indexOf(e);console.log(n),-1!==n&&(k.splice(n,1),F("")),O(k)},children:k.length>=1||(null==t?void 0:t.avatar)?(null==t?void 0:t.avatar)?(0,r.jsx)("img",{src:null==t?void 0:t.avatar,alt:""}):"":L})}),(0,r.jsx)(l.Z.Item,{colon:!1,children:(0,r.jsx)(c.ZP,{size:"large",htmlType:"submit",className:p().btn,children:(null==t?void 0:t._id)?"更新":"创建"})})]})})}},93812:function(e,n,t){"use strict";var r,s,l,a,u,i,o,c;t.d(n,{Em:function(){return d},N1:function(){return s},Om:function(){return r},Q_:function(){return a},iy:function(){return l}}),(u=r||(r={})).MALE="male",u.FEMALE="female",(i=s||(s={})).BUYER="buyer",i.SELLER="seller",i.ADMIN="admin",(o=l||(l={})).ON="on",o.OFF="off",(c=a||(a={})).ON="on",c.OFF="off";let d=[{label:"正常",value:"on"},{label:"禁用",value:"off"}]},49135:function(e,n,t){"use strict";var r=t(7908),s=t(37134),l=t(80588);n.Z=(e=>{let n=r.Z.create({timeout:5e3,...e});return n.interceptors.request.use(function(e){let n=localStorage.getItem("user"),t=n?JSON.parse(n).token:"";return e.headers.Authorization="Bearer "+t,e},function(e){return Promise.reject(e)}),n.interceptors.response.use(function(e){let{status:n,data:t,message:r}=e;return 200===n?t:401===n?s.default.push("/login"):void l.ZP.error(r||"服务端异常")},function(e){var n,t;return e.response&&401===e.response.status?s.default.push("/login"):(l.ZP.error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(n=t.data)||void 0===n?void 0:n.message)||"服务端异常"),Promise.reject(e))}),n})({})},71583:function(e){e.exports={content:"Content_content__iP7sw",title:"Content_title__y3NnI",btn:"Content_btn__bySTU"}},17570:function(e){e.exports={btn:"UserForm_btn__5o2Sp"}}},function(e){e.O(0,[4634,534,3565,7172,1583,7119,3374,1773,2874,8022,2971,8069,1744],function(){return e(e.s=80176)}),_N_E=e.O()}]);