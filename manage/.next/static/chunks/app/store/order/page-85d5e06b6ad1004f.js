(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4384],{24654:function(){},93170:function(e,t,n){Promise.resolve().then(n.bind(n,23438))},28683:function(e,t,n){"use strict";var r=n(90791);t.Z=r.Z},38302:function(e,t,n){"use strict";var r=n(97814);t.Z=r.Z},6053:function(e,t,n){"use strict";n.d(t,{Z:function(){return P}});var r=n(64090),o=n(81303),a=n(16480),c=n.n(a),l=n(29810),i=n(18606),s=n(79934),u=n(57499),d=n(8985),p=n(6336),g=n(11303),f=n(80316),h=n(76585);let m=e=>{let{paddingXXS:t,lineWidth:n,tagPaddingHorizontal:r,componentCls:o,calc:a}=e,c=a(r).sub(n).equal(),l=a(t).sub(n).equal();return{[o]:Object.assign(Object.assign({},(0,g.Wf)(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:c,fontSize:e.tagFontSize,lineHeight:e.tagLineHeight,whiteSpace:"nowrap",background:e.defaultBg,border:"".concat((0,d.bf)(e.lineWidth)," ").concat(e.lineType," ").concat(e.colorBorder),borderRadius:e.borderRadiusSM,opacity:1,transition:"all ".concat(e.motionDurationMid),textAlign:"start",position:"relative",["&".concat(o,"-rtl")]:{direction:"rtl"},"&, a, a:hover":{color:e.defaultColor},["".concat(o,"-close-icon")]:{marginInlineStart:l,fontSize:e.tagIconSize,color:e.colorTextDescription,cursor:"pointer",transition:"all ".concat(e.motionDurationMid),"&:hover":{color:e.colorTextHeading}},["&".concat(o,"-has-color")]:{borderColor:"transparent",["&, a, a:hover, ".concat(e.iconCls,"-close, ").concat(e.iconCls,"-close:hover")]:{color:e.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",["&:not(".concat(o,"-checkable-checked):hover")]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},"&-hidden":{display:"none"},["> ".concat(e.iconCls," + span, > span + ").concat(e.iconCls)]:{marginInlineStart:c}}),["".concat(o,"-borderless")]:{borderColor:"transparent",background:e.tagBorderlessBg}}},b=e=>{let{lineWidth:t,fontSizeIcon:n,calc:r}=e,o=e.fontSizeSM;return(0,f.TS)(e,{tagFontSize:o,tagLineHeight:(0,d.bf)(r(e.lineHeightSM).mul(o).equal()),tagIconSize:r(n).sub(r(t).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:e.colorFillTertiary})},y=e=>({defaultBg:new p.C(e.colorFillQuaternary).onBackground(e.colorBgContainer).toHexString(),defaultColor:e.colorText});var v=(0,h.I$)("Tag",e=>m(b(e)),y),x=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)0>t.indexOf(r[o])&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n};let C=r.forwardRef((e,t)=>{let{prefixCls:n,style:o,className:a,checked:l,onChange:i,onClick:s}=e,d=x(e,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:p,tag:g}=r.useContext(u.E_),f=p("tag",n),[h,m,b]=v(f),y=c()(f,"".concat(f,"-checkable"),{["".concat(f,"-checkable-checked")]:l},null==g?void 0:g.className,a,m,b);return h(r.createElement("span",Object.assign({},d,{ref:t,style:Object.assign(Object.assign({},o),null==g?void 0:g.style),className:y,onClick:e=>{null==i||i(!l),null==s||s(e)}})))});var k=n(82303);let Z=e=>(0,k.Z)(e,(t,n)=>{let{textColor:r,lightBorderColor:o,lightColor:a,darkColor:c}=n;return{["".concat(e.componentCls).concat(e.componentCls,"-").concat(t)]:{color:r,background:a,borderColor:o,"&-inverse":{color:e.colorTextLightSolid,background:c,borderColor:c},["&".concat(e.componentCls,"-borderless")]:{borderColor:"transparent"}}}});var j=(0,h.bk)(["Tag","preset"],e=>Z(b(e)),y);let w=(e,t,n)=>{let r="string"!=typeof n?n:n.charAt(0).toUpperCase()+n.slice(1);return{["".concat(e.componentCls).concat(e.componentCls,"-").concat(t)]:{color:e["color".concat(n)],background:e["color".concat(r,"Bg")],borderColor:e["color".concat(r,"Border")],["&".concat(e.componentCls,"-borderless")]:{borderColor:"transparent"}}}};var S=(0,h.bk)(["Tag","status"],e=>{let t=b(e);return[w(t,"success","Success"),w(t,"processing","Info"),w(t,"error","Error"),w(t,"warning","Warning")]},y),O=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)0>t.indexOf(r[o])&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n};let I=r.forwardRef((e,t)=>{let{prefixCls:n,className:a,rootClassName:d,style:p,children:g,icon:f,color:h,onClose:m,closeIcon:b,closable:y,bordered:x=!0}=e,C=O(e,["prefixCls","className","rootClassName","style","children","icon","color","onClose","closeIcon","closable","bordered"]),{getPrefixCls:k,direction:Z,tag:w}=r.useContext(u.E_),[I,P]=r.useState(!0);r.useEffect(()=>{"visible"in C&&P(C.visible)},[C.visible]);let _=(0,l.o2)(h),N=(0,l.yT)(h),T=_||N,E=Object.assign(Object.assign({backgroundColor:h&&!T?h:void 0},null==w?void 0:w.style),p),F=k("tag",n),[z,B,H]=v(F),M=c()(F,null==w?void 0:w.className,{["".concat(F,"-").concat(h)]:T,["".concat(F,"-has-color")]:h&&!T,["".concat(F,"-hidden")]:!I,["".concat(F,"-rtl")]:"rtl"===Z,["".concat(F,"-borderless")]:!x},a,d,B,H),Y=e=>{e.stopPropagation(),null==m||m(e),e.defaultPrevented||P(!1)},[,A]=(0,i.Z)(y,b,e=>null===e?r.createElement(o.Z,{className:"".concat(F,"-close-icon"),onClick:Y}):r.createElement("span",{className:"".concat(F,"-close-icon"),onClick:Y},e),null,!1),D="function"==typeof C.onClick||g&&"a"===g.type,R=f||null,L=R?r.createElement(r.Fragment,null,R,g&&r.createElement("span",null,g)):g,q=r.createElement("span",Object.assign({},C,{ref:t,className:M,style:E}),L,A,_&&r.createElement(j,{key:"preset",prefixCls:F}),N&&r.createElement(S,{key:"status",prefixCls:F}));return z(D?r.createElement(s.Z,{component:"Tag"},q):q)});I.CheckableTag=C;var P=I},39241:function(e,t,n){"use strict";n.d(t,{Ge:function(){return u},Ou:function(){return i},Y:function(){return l},od:function(){return c},wZ:function(){return s}});var r=n(49135),o=n(13374),a=n.n(o);async function c(e){return r.Z.get("/api/goods?".concat(a().stringify(e)))}async function l(e){return r.Z.post("/api/goods",e)}async function i(e){return r.Z.delete("/api/goods/".concat(e))}async function s(e){return r.Z.get("/api/goods/".concat(e))}async function u(e,t){return r.Z.put("/api/goods/".concat(e),t)}},77533:function(e,t,n){"use strict";n.d(t,{FB:function(){return l},Fw:function(){return c},Pz:function(){return s},s$:function(){return i}});var r=n(49135),o=n(13374),a=n.n(o);async function c(e){return r.Z.get("/api/orders?".concat(a().stringify(e)))}async function l(e){return r.Z.delete("/api/orders/".concat(e))}async function i(e){return r.Z.get("/api/orders/".concat(e))}async function s(e,t){return r.Z.put("/api/orders/".concat(e),t)}},23438:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return I}});var r=n(3827),o=n(6053),a=n(54547),c=n(81583),l=n(32743),i=n(80588),s=n(65270),u=n(13565),d=n(38302),p=n(28683),g=n(44839),f=n(82047),h=n(52336),m=n(20703),b=n(47907),y=n(64090),v=n(48956),x=n.n(v),C=n(89539),k=n.n(C),Z=n(20629),j=n(77533),w=n(39241);let S=[{label:"待付款",value:"unpaid"},{label:"已付款",value:"paid"},{label:"已发货",value:"delivered"},{label:"已收货",value:"recieved"},{label:"待退款",value:"waitRefund"},{label:"已退款",value:"refunded"}],O=[{title:"名称",dataIndex:"goods",key:"name",width:170,render:e=>null==e?void 0:e.name},{title:"图片",dataIndex:"goods",key:"pics",width:200,render:e=>(0,r.jsx)(m.default,{src:e.pics[0].url,width:200,height:200,alt:""})},{title:"数量",dataIndex:"num",key:"num",width:80},{title:"状态",dataIndex:"status",key:"status",width:80,render:e=>{switch(e){case"unpaid":return(0,r.jsx)(o.Z,{color:"purple",children:"待付款"});case"paid":return(0,r.jsx)(o.Z,{color:"gold",children:"已付款"});case"delivered":return(0,r.jsx)(o.Z,{color:"green",children:"已发货"});case"received":return(0,r.jsx)(o.Z,{color:"blue",children:"已收货"});case"waitRefund":return(0,r.jsx)(o.Z,{color:"red",children:"待退款"});case"refunded":return(0,r.jsx)(o.Z,{children:"已退款"});default:return(0,r.jsx)(o.Z,{children:e})}}},{title:"交易金额",dataIndex:"num",key:"num",width:100,render:(e,t)=>(t.num*t.goods.price).toString()+"元"},{title:"买家",dataIndex:"buyer",key:"buyer",width:80},{title:"创建时间",dataIndex:"createdAt",key:"createdAt",render:e=>k()(e).format("YYYY-MM-DD"),width:130},{title:"确认收货时间",dataIndex:"confirmedAt",key:"confirmedAt",render:e=>k()(e).format("YYYY-MM-DD"),width:130},{title:"订单评价",dataIndex:"comment",key:"comment",ellipsis:!0,render:e=>{console.log(e);let t=e?e.description:"-";return(0,r.jsx)(a.Z,{title:t,placement:"topLeft",children:t})},width:130}];function I(){let[e]=c.Z.useForm(),t=(0,b.useRouter)(),[n,o]=(0,y.useState)({current:1,pageSize:20,showSizeChanger:!0,total:0}),[a,m]=(0,y.useState)();async function v(e){let t=await (0,j.Fw)({current:n.current,pageSize:n.pageSize,...e,seller:localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")||"").info._id:""});console.log(t);let{data:r}=t;m(r.map(e=>({...e,buyer:e.buyer.nickName,name:e.goods.name}))),o({...n,current:1,total:t.total})}(0,y.useEffect)(()=>{v(),(0,j.Fw)({all:!0}).then(e=>{})},[]);let C=e=>{t.push("/store/order/edit/".concat(e))},k=t=>{l.Z.confirm({title:"确定删除?",okText:"确定",cancelText:"取消",async onOk(){await (0,j.FB)(t),i.ZP.success("删除成功"),v(e.getFieldsValue())}})},I=[...O,{title:"操作",key:"action",width:200,render:(e,t)=>(0,r.jsxs)(s.Z,{children:[(0,r.jsx)(u.ZP,{type:"link",onClick:()=>{C(t._id)},children:"详情"}),(0,r.jsx)(u.ZP,{type:"link",danger:!0,onClick:()=>k(t._id),children:"删除"})]})}],P=async e=>{console.log(e);let t=await (0,w.od)({name:e.goods});t.data[0]?e.goods=t.data[0]._id:e.goods="";let r=await (0,j.Fw)({...e,current:n.current,pageSize:n.pageSize});console.log(r),m(r.data.map(e=>({...e}))),o({...n,current:1,total:r.total})};return(0,r.jsxs)(Z.Z,{title:"订单列表",children:[(0,r.jsx)(c.Z,{name:"search",form:e,onFinish:P,initialValues:{name:"",category:""},children:(0,r.jsxs)(d.Z,{gutter:24,children:[(0,r.jsx)(p.Z,{span:8,children:(0,r.jsx)(c.Z.Item,{name:"goods",label:"商品名称",children:(0,r.jsx)(g.default,{placeholder:"请输入",allowClear:!0})})}),(0,r.jsx)(p.Z,{span:8,children:(0,r.jsx)(c.Z.Item,{name:"status",label:"状态",children:(0,r.jsx)(f.default,{placeholder:"请选择",options:S,optionFilterProp:"label",allowClear:!0,showSearch:!0,style:{width:"150"}})})}),(0,r.jsx)(p.Z,{span:8,children:(0,r.jsx)(c.Z.Item,{children:(0,r.jsxs)(s.Z,{children:[(0,r.jsx)(u.ZP,{htmlType:"submit",children:"搜索"}),(0,r.jsx)(u.ZP,{onClick:()=>{e.resetFields()},htmlType:"submit",children:"清空"})]})})})]})}),(0,r.jsx)("div",{className:x().tablewrap,children:(0,r.jsx)(h.Z,{dataSource:a,columns:I,scroll:{x:1e3,y:500},pagination:{...n,showTotal:()=>"共 ".concat(n.total," 条")},onChange:t=>{var n;o(t);let r=e.getFieldsValue();(0,j.Fw)({current:t.current,pageSize:t.pageSize,...r,seller:null===(n=JSON.parse(localStorage.getItem("user")||""))||void 0===n?void 0:n.info._id})}})})]})}},20629:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(3827);n(64090);var o=n(71583),a=n.n(o);function c(e){let{children:t,title:n,operation:o}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:a().title,children:[n,(0,r.jsx)("span",{className:a().btn,children:o})]}),(0,r.jsx)("div",{className:a().content,children:t})]})}},49135:function(e,t,n){"use strict";var r=n(7908),o=n(37134),a=n(80588);t.Z=(e=>{let t=r.Z.create({timeout:5e3,...e});return t.interceptors.request.use(function(e){let t=localStorage.getItem("user"),n=t?JSON.parse(t).token:"";return e.headers.Authorization="Bearer "+n,e},function(e){return Promise.reject(e)}),t.interceptors.response.use(function(e){let{status:t,data:n,message:r}=e;return 200===t?n:401===t?o.default.push("/login"):void a.ZP.error(r||"服务端异常")},function(e){var t,n;return e.response&&401===e.response.status?o.default.push("/login"):(a.ZP.error((null==e?void 0:null===(n=e.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.message)||"服务端异常"),Promise.reject(e))}),t})({})},48956:function(e){e.exports={tablewrap:"order_tablewrap__BHX2H"}},71583:function(e){e.exports={content:"Content_content__iP7sw",title:"Content_title__y3NnI",btn:"Content_btn__bySTU"}}},function(e){e.O(0,[4634,534,3565,7172,1583,7119,3374,1716,1026,1773,8728,491,2422,703,2971,8069,1744],function(){return e(e.s=93170)}),_N_E=e.O()}]);