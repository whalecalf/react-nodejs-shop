(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6514],{24654:function(){},99277:function(e,t,n){Promise.resolve().then(n.bind(n,88544))},42987:function(e,t,n){"use strict";n.d(t,{AT:function(){return a},GC:function(){return i},lI:function(){return l},m7:function(){return u},y1:function(){return c}});var r=n(49135),o=n(13374),s=n.n(o);async function a(e){return r.Z.get("/api/categories?".concat(s().stringify(e)))}async function i(e){return r.Z.post("/api/categories",e)}async function l(e){return r.Z.delete("/api/categories/".concat(e))}async function u(e){return r.Z.get("/api/categories/".concat(e))}async function c(e,t){return r.Z.put("/api/categories/".concat(e),t)}},39241:function(e,t,n){"use strict";n.d(t,{Ge:function(){return c},Ou:function(){return l},Y:function(){return i},od:function(){return a},wZ:function(){return u}});var r=n(49135),o=n(13374),s=n.n(o);async function a(e){return r.Z.get("/api/goods?".concat(s().stringify(e)))}async function i(e){return r.Z.post("/api/goods",e)}async function l(e){return r.Z.delete("/api/goods/".concat(e))}async function u(e){return r.Z.get("/api/goods/".concat(e))}async function c(e,t){return r.Z.put("/api/goods/".concat(e),t)}},10980:function(e,t,n){"use strict";n.d(t,{g:function(){return o}});var r=n(49135);async function o(e){return r.Z.post("/api/upload",e)}},88544:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var r=n(3827),o=n(39241),s=n(42507),a=n(47907),i=n(64090);function l(){let e=(0,a.useParams)(),t=e.id,[n,l]=(0,i.useState)({});return(0,i.useEffect)(()=>{(async()=>{if(t){let e=await (0,o.wZ)(t);console.log(e),l(e.data)}})()},[e]),(0,r.jsx)(s.default,{title:"商品编辑",data:n})}},20629:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(3827);n(64090);var o=n(71583),s=n.n(o);function a(e){let{children:t,title:n,operation:o}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:s().title,children:[n,(0,r.jsx)("span",{className:s().btn,children:o})]}),(0,r.jsx)("div",{className:s().content,children:t})]})}},42507:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return I}});var r=n(3827),o=n(64090),s=n(66155),a=n(74325),i=n(44839),l=n(81583),u=n(80588),c=n(82047),d=n(55211),f=n(88707),p=n(66577),m=n(32743),g=n(13565),h=n(39241),Z=n(47907),v=n(41091),x=n.n(v),j=n(89539),y=n.n(j),b=n(20629),_=n(10980),w=n(42987),P=n(22319);let{TextArea:k}=i.default;function I(e){let{title:t,data:n}=e,v=(0,Z.useRouter)(),[j,I]=(0,o.useState)([]),[S]=l.Z.useForm(),[N,C]=(0,o.useState)(!1),[A,q]=(0,o.useState)(),E=JSON.parse(localStorage.getItem("user")||"").info,[O,G]=(0,o.useState)(!1),[T,F]=(0,o.useState)(""),[z,L]=(0,o.useState)(""),[J,U]=(0,o.useState)([]);(0,o.useEffect)(()=>{if(console.log(n),null==n?void 0:n._id){var e;S.setFieldsValue({...n,createdAt:y()(n.createdAt),category:null==n?void 0:null===(e=n.category)||void 0===e?void 0:e._id}),U(n.pics)}},[n,S]),(0,o.useEffect)(()=>{(0,w.AT)({all:!0}).then(e=>{I(e.data.data)})},[]);let Y=async e=>{e.createdAt&&(e.createdAt=y()(e.createdAt).valueOf()),e.pics=J,e.seller=E._id,(null==n?void 0:n._id)?(await (0,h.Ge)(null==n?void 0:n._id,e),u.ZP.success("更新成功")):(console.log("values",e),await (0,h.Y)(e),u.ZP.success("创建成功")),v.push("/goods")};(0,o.useEffect)(()=>{(async()=>{await (0,_.g)().then(e=>{console.log("token",e.data.token),L(e.data.token)})})()},[]);let R=(0,r.jsxs)("button",{style:{border:0,background:"none"},type:"button",children:[N?(0,r.jsx)(s.Z,{}):(0,r.jsx)(a.Z,{}),(0,r.jsx)("div",{style:{marginTop:8},children:"上传"})]});return(0,r.jsx)(b.Z,{title:t,children:(0,r.jsxs)(l.Z,{labelCol:{span:4},wrapperCol:{span:16},layout:"horizontal",onFinish:Y,form:S,children:[(0,r.jsx)(l.Z.Item,{label:"名称",name:"name",rules:[{required:!0,message:"请输入名称"}],children:(0,r.jsx)(i.default,{placeholder:"请输入"})}),(0,r.jsx)(l.Z.Item,{label:"分类",name:"category",rules:[{required:!0,message:"请选择分类"}],children:(0,r.jsx)(c.default,{placeholder:"请选择",options:j.map(e=>({label:e.name,value:e._id}))})}),(0,r.jsx)(l.Z.Item,{label:"上架时间",name:"createdAt",children:(0,r.jsx)(d.default,{placeholder:"请选择"})}),(0,r.jsx)(l.Z.Item,{label:"价格",name:"price",rules:[{required:!0,message:"请输入价格"}],children:(0,r.jsx)(f.Z,{placeholder:"请输入"})}),(0,r.jsx)(l.Z.Item,{label:"库存",name:"stock",rules:[{required:!0,message:"请输入库存"}],children:(0,r.jsx)(f.Z,{placeholder:"请输入"})}),(0,r.jsx)(l.Z.Item,{label:"描述",name:"description",rules:[{required:!0,message:"请输入描述"}],children:(0,r.jsx)(k,{placeholder:"请输入",rows:4})}),(0,r.jsx)(l.Z.Item,{label:"图片",name:"pics",tooltip:"图片数量不超过10张",children:(0,r.jsx)(p.Z,{name:"file",listType:"picture-card",className:"avatar-uploader",action:"http://upload-z2.qiniup.com",data:{token:z},beforeUpload:e=>{let t="image/jpeg"===e.type||"image/png"===e.type;return t||u.ZP.error("You can only upload JPG/PNG file!"),t},fileList:J,onPreview:e=>{console.log(e),F(e.url||e.thumbUrl),G(!0)},onChange:e=>{let t=e.file,n=e.fileList;console.log("fileList",e.fileList);let{uid:r,name:o,type:s,thumbUrl:a,status:i,response:l={}}=t,u={uid:r,name:o,type:s,thumbUrl:a,status:i,url:P._+(l.hash||"")};n.pop(),n.push(u),q(u.url),console.log(n),U([...n])},onRemove:e=>{console.log(e),q("");let t=J.indexOf(e);-1!==t&&(J.splice(t,1),U(J))},children:J.length>9?"":R})}),(0,r.jsx)(l.Z.Item,{children:(0,r.jsx)(m.Z,{open:O,title:"预览",footer:null,onCancel:()=>{G(!1),F("")},children:(0,r.jsx)("img",{alt:"example",style:{width:"100%"},src:T})})}),(0,r.jsx)(l.Z.Item,{colon:!1,children:(0,r.jsx)(g.ZP,{size:"large",htmlType:"submit",className:x().btn,children:(null==n?void 0:n._id)?"更新":"创建"})})]})})}},22319:function(e,t,n){"use strict";n.d(t,{_:function(){return r}});let r="http://sw1e12f9k.hn-bkt.clouddn.com/"},49135:function(e,t,n){"use strict";var r=n(7908),o=n(37134),s=n(80588);t.Z=(e=>{let t=r.Z.create({timeout:5e3,...e});return t.interceptors.request.use(function(e){let t=localStorage.getItem("user"),n=t?JSON.parse(t).token:"";return e.headers.Authorization="Bearer "+n,e},function(e){return Promise.reject(e)}),t.interceptors.response.use(function(e){let{status:t,data:n,message:r}=e;return 200===t?n:401===t?o.default.push("/login"):void s.ZP.error(r||"服务端异常")},function(e){var t,n;return e.response&&401===e.response.status?o.default.push("/login"):(s.ZP.error((null==e?void 0:null===(n=e.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.message)||"服务端异常"),Promise.reject(e))}),t})({})},71583:function(e){e.exports={content:"Content_content__iP7sw",title:"Content_title__y3NnI",btn:"Content_btn__bySTU"}},41091:function(e){e.exports={btn:"GoodsForm_btn__kvbe7"}}},function(e){e.O(0,[4634,534,3565,7172,1583,7119,3374,1716,1026,8728,2874,5211,8707,2971,8069,1744],function(){return e(e.s=99277)}),_N_E=e.O()}]);