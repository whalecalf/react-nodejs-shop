(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3801],{24654:function(){},85500:function(e,t,n){Promise.resolve().then(n.bind(n,9074))},28683:function(e,t,n){"use strict";var r=n(90791);t.Z=r.Z},38302:function(e,t,n){"use strict";var r=n(97814);t.Z=r.Z},42987:function(e,t,n){"use strict";n.d(t,{AT:function(){return c},GC:function(){return o},lI:function(){return s},m7:function(){return l},y1:function(){return u}});var r=n(49135),i=n(13374),a=n.n(i);async function c(e){return r.Z.get("/api/categories?".concat(a().stringify(e)))}async function o(e){return r.Z.post("/api/categories",e)}async function s(e){return r.Z.delete("/api/categories/".concat(e))}async function l(e){return r.Z.get("/api/categories/".concat(e))}async function u(e,t){return r.Z.put("/api/categories/".concat(e),t)}},39241:function(e,t,n){"use strict";n.d(t,{Ge:function(){return u},Ou:function(){return s},Y:function(){return o},od:function(){return c},wZ:function(){return l}});var r=n(49135),i=n(13374),a=n.n(i);async function c(e){return r.Z.get("/api/goods?".concat(a().stringify(e)))}async function o(e){return r.Z.post("/api/goods",e)}async function s(e){return r.Z.delete("/api/goods/".concat(e))}async function l(e){return r.Z.get("/api/goods/".concat(e))}async function u(e,t){return r.Z.put("/api/goods/".concat(e),t)}},9074:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return S}});var r=n(3827),i=n(54547),a=n(81583),c=n(32743),o=n(80588),s=n(65270),l=n(13565),u=n(38302),d=n(28683),p=n(44839),f=n(82047),h=n(52336),g=n(20703),Z=n(47907),x=n(64090),y=n(66615),m=n.n(y),j=n(89539),w=n.n(j),k=n(39241),v=n(20629),_=n(42987);let b=[{title:"名称",dataIndex:"name",key:"name",width:170},{title:"图片",dataIndex:"pics",key:"pics",width:300,render:e=>{var t;return e.length>0&&(t=(0,r.jsx)(g.default,{src:e[0].url,width:200,height:200,alt:""})),t}},{title:"描述",dataIndex:"description",key:"description",ellipsis:!0,width:300,render:e=>(0,r.jsx)(i.Z,{title:e,placement:"topLeft",children:e})},{title:"分类",dataIndex:"category",key:"category",width:150,render:e=>null==e?void 0:e.name},{title:"价格",dataIndex:"price",key:"price",width:80},{title:"库存",dataIndex:"stock",key:"stock",width:80},{title:"上架时间",dataIndex:"createdAt",key:"createdAt",render:e=>w()(e).format("YYYY-MM-DD"),width:130}];function S(){let[e]=a.Z.useForm(),t=(0,Z.useRouter)(),[n,i]=(0,x.useState)({current:1,pageSize:20,showSizeChanger:!0,total:0}),[g,y]=(0,x.useState)(),[j,w]=(0,x.useState)([]);async function S(e){let t=await (0,k.od)({current:n.current,pageSize:n.pageSize,...e});console.log(t);let{data:r}=t;y(r),i({...n,current:1,total:t.total})}(0,x.useEffect)(()=>{S(),(0,_.AT)({all:!0}).then(e=>{console.log(e),w(e.data.data)})},[]);let C=async t=>{i(t);let n=e.getFieldValue(name);y((await (0,k.od)({current:t.current,pageSize:t.pageSize,...n})).data)},I=e=>{t.push("/goods/edit/".concat(e))},P=t=>{c.Z.confirm({title:"确定删除?",okText:"确定",cancelText:"取消",async onOk(){await (0,k.Ou)(t),o.ZP.success("删除成功"),S(e.getFieldsValue())}})},z=[...b,{title:"操作",key:"action",render:(e,t)=>(0,r.jsxs)(s.Z,{children:[(0,r.jsx)(l.ZP,{type:"link",onClick:()=>{I(t._id)},children:"编辑"}),(0,r.jsx)(l.ZP,{type:"link",danger:!0,onClick:()=>P(t._id),children:"删除"})]})}],N=async e=>{let t=await (0,k.od)({...e,current:n.current,pageSize:n.pageSize});y(t.data),i({...n,current:1,total:t.total})};return(0,r.jsxs)(v.Z,{title:"商品列表",operation:(0,r.jsx)(l.ZP,{onClick:()=>{t.push("/goods/add")},children:"添加"}),children:[(0,r.jsx)(a.Z,{name:"search",form:e,onFinish:N,initialValues:{name:"",category:""},children:(0,r.jsxs)(u.Z,{gutter:24,children:[(0,r.jsx)(d.Z,{span:8,children:(0,r.jsx)(a.Z.Item,{name:"name",label:"名称",children:(0,r.jsx)(p.default,{placeholder:"请输入",allowClear:!0})})}),(0,r.jsx)(d.Z,{span:8,children:(0,r.jsx)(a.Z.Item,{name:"category",label:"分类",children:(0,r.jsx)(f.default,{placeholder:"请选择",options:j.map(e=>({label:e.name,value:e._id})),optionFilterProp:"label",allowClear:!0,showSearch:!0,style:{width:"150"}})})}),(0,r.jsx)(d.Z,{span:8,children:(0,r.jsx)(a.Z.Item,{children:(0,r.jsxs)(s.Z,{children:[(0,r.jsx)(l.ZP,{htmlType:"submit",children:"搜索"}),(0,r.jsx)(l.ZP,{onClick:()=>{console.log(e),e.resetFields()},htmlType:"submit",children:"清空"})]})})})]})}),(0,r.jsx)("div",{className:m().tablewrap,children:(0,r.jsx)(h.Z,{dataSource:g,columns:z,scroll:{x:1e3,y:500},pagination:{...n,showTotal:()=>"共 ".concat(n.total," 条")},onChange:C})})]})}},20629:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(3827);n(64090);var i=n(71583),a=n.n(i);function c(e){let{children:t,title:n,operation:i}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:a().title,children:[n,(0,r.jsx)("span",{className:a().btn,children:i})]}),(0,r.jsx)("div",{className:a().content,children:t})]})}},49135:function(e,t,n){"use strict";var r=n(7908),i=n(37134),a=n(80588);t.Z=(e=>{let t=r.Z.create({timeout:5e3,...e});return t.interceptors.request.use(function(e){let t=localStorage.getItem("user"),n=t?JSON.parse(t).token:"";return e.headers.Authorization="Bearer "+n,e},function(e){return Promise.reject(e)}),t.interceptors.response.use(function(e){let{status:t,data:n,message:r}=e;return 200===t?n:401===t?i.default.push("/login"):void a.ZP.error(r||"服务端异常")},function(e){var t,n;return e.response&&401===e.response.status?i.default.push("/login"):(a.ZP.error((null==e?void 0:null===(n=e.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.message)||"服务端异常"),Promise.reject(e))}),t})({})},66615:function(e){e.exports={tablewrap:"goods_tablewrap__JBh2Q"}},71583:function(e){e.exports={content:"Content_content__iP7sw",title:"Content_title__y3NnI",btn:"Content_btn__bySTU"}}},function(e){e.O(0,[4634,534,3565,7172,1583,7119,3374,1716,1026,1773,8728,491,2422,703,2971,8069,1744],function(){return e(e.s=85500)}),_N_E=e.O()}]);